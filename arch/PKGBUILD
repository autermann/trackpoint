# Maintainer: Christian Autermann <christian@autermann.org>
_pkgname=trackpoint
pkgname=${_pkgname}-git
pkgver=1.0.0
pkgrel=1
pkgdesc="Trackpoint is a tool to control ThinkPad trackpoint settings"
arch=(x86_64)
url="https://github.com/autermann/trackpoint"
license=('GPL2')
makedepends=(go)
options=('!strip')
backup=(etc/trackpoint.yml)
source=("${pkgname}::git+${url}.git")
sha512sums=('SKIP')

prepare() {
	cd ${pkgname}
	export GOPATH="$(pwd)/go"
	go get github.com/cheekybits/genny
	go get -d -v
}

build() {
	cd ${pkgname}
	export GOPATH="$(pwd)/go"
	go generate
	go build -o "${_pkgname}" 
}

package() {
	cd "$pkgname"
	install -Dm755 "${_pkgname}" "${pkgdir}/usr/bin/${_pkgname}"
	install -Dm644 "${_pkgname}.service" "${pkgdir}/usr/lib/systemd/system/${_pkgname}.service"
	install -Dm644 "${_pkgname}.yml" "${pkgdir}/etc/${_pkgname}.yml"
	install -Dm644 LICENSE "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"
}
